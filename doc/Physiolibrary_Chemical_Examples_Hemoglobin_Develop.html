<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Physiolibrary.Chemical.Examples.Hemoglobin.Develop</title>
<meta name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial, sans-serif; }
.modelica, .modelica * { font-size: 9pt; font-family: Courier, monospace; white-space: pre; }
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address { font-weight: normal; }
td      { border: 1px solid #808080; vertical-align: top; }
th      { border: 1px solid #808080; vertical-align: top; font-weight: bold; }
table   { border: 1px solid #808080; border-collapse: collapse; }
</style>
</head>
<body>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Develop<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Physiolibrary.Chemical.Examples.Hemoglobin.Develop"></a><a href="Physiolibrary_Chemical_Examples_Hemoglobin.html#Physiolibrary.Chemical.Examples.Hemoglobin"
>Physiolibrary.Chemical.Examples.Hemoglobin</a>.Develop</h2>
<p>
</p>
<h3>Information</h3>
<p>Extends from <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.UnderConstruction"
>Modelica.Icons.UnderConstruction</a> (Icon for classes that are still under construction).</p>
<h3>Package Content</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Package Content">
<tr>
<th>Name</th>
<th>Description</th>
</tr>
<tr>
<td><img src="Physiolibrary.Chemical.Ex60ecc015dcec4c6ayFormS.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.QuaternaryForm" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.QuaternaryForm"
>QuaternaryForm</a>
</td>
<td>Model of hemoglobin space-structure form (can be parametrized as relaxed or tensed)</td>
</tr>
<tr>
<td><img src="Physiolibrary.Chemical.Exad26898b5f385b97obin2S.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin2" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin2"
>Hemoglobin2</a>
</td>
<td>Hemoglobin model</td>
</tr>
<tr>
<td><img src="Physiolibrary.Chemical.Exa0f7da7d66b9af82ationS.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_oxygenation" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_oxygenation"
>Hemoglobin_oxygenation</a>
</td>
<td>Hemoglobin oxygenation experiment</td>
</tr>
<tr>
<td><img src="Physiolibrary.Chemical.Exe7147a02e95496f4ationS.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration"
>Hemoglobin_titration</a>
</td>
<td>Hemoglobin titration experiment</td>
</tr>
<tr>
<td><img src="Physiolibrary.Chemical.Ex94a14f266a11a303hiftsS.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration_shifts" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration_shifts"
>Hemoglobin_titration_shifts</a>
</td>
<td>Hemoglobin titration shift caused by full deoxygenation (Bohr protons binding)</td>
</tr>
</table>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE QuaternaryForm<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Chemical.Ex60ecc015dcec4c6ayFormI.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.QuaternaryForm" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.QuaternaryForm"></a><a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop"
>Physiolibrary.Chemical.Examples.Hemoglobin.Develop</a>.QuaternaryForm</h2>
<p>
<b>Model of hemoglobin space-structure form (can be parametrized as relaxed or tensed)</b>
<br>
<br><img src="Physiolibrary.Chemical.Ex60ecc015dcec4c6ayFormD.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.QuaternaryForm">
</p>
<h3>Information</h3>

<p>[1] Morrow J, Matthew J, Wittebort R, Gurd F. Carbon 13 resonances of 13CO2 carbamino adducts of alpha and beta chains in human adult hemoglobin. Journal of Biological Chemistry 1976;251:477-84.</p>
<p>[2] Bauer C, Schr&ouml;der E. Carbamino compounds of haemoglobin in human adult and foetal blood. The Journal of physiology 1972;227:457-71.</p>
<p>[3] Antonini E, Wyman J, Brunori M, Fronticelli C, Bucci E, Rossi-Fanelli A. Studies on the relations between molecular and functional properties of hemoglobin V. The influence of temperature on the Bohr effect in human and in horse hemoglobin. Journal of Biological Chemistry 1965;240:1096-103.</p>

<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>Boolean</td><td>isDependent</td><td>false</td><td>&nbsp;</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Concentration</a></td><td>KA</td><td>10^(-6.89 + 3)</td><td>dissociation coefficient for acid chains of subunit [mol/m3]</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Concentration</a></td><td>Kz</td><td>10^(-7.25 + 3)</td><td>valine 1 amino terminus dissociation coefficient of protonation to NH3+ [mol/m3]</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Concentration</a></td><td>Kc</td><td>10^(-8.35 + 3)</td><td>valine 1 amino terminus dissociation coefficient of protonation to NH3+ [mol/m3]</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Concentration</a></td><td>KO2</td><td>0.000671946</td><td>oxygen dissociation coefficient of hemoglobin subunit [mol/m3]</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>ChemicalPort_a</a></td><td>O2</td><td>&nbsp;</td></tr>
<tr><td><a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>ChemicalPort_a</a></td><td>sForm</td><td>&nbsp;</td></tr>
<tr><td><a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>ChemicalPort_a</a></td><td>H</td><td>hydrogen ion (proton)</td></tr>
<tr><td><a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>ChemicalPort_a</a></td><td>CO2</td><td>&nbsp;</td></tr>
<tr><td>output <a href="Physiolibrary_Types_RealIO.html#Physiolibrary.Types.RealIO.AmountOfSubstanceOutput"
>AmountOfSubstanceOutput</a></td><td>tAmount</td><td>[mol]</td></tr>
<tr><td>output <a href="Physiolibrary_Types_RealIO.html#Physiolibrary.Types.RealIO.AmountOfSubstanceOutput"
>AmountOfSubstanceOutput</a></td><td>protonation</td><td>[mol]</td></tr>
<tr><td>output <a href="Physiolibrary_Types_RealIO.html#Physiolibrary.Types.RealIO.AmountOfSubstanceOutput"
>AmountOfSubstanceOutput</a></td><td>oxygenation</td><td>[mol]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> QuaternaryForm <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Model of hemoglobin space-structure form (can be parametrized as relaxed or tensed)&quot;</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span>Boolean isDependent = false;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Types.Concentration</a> KA = 10^(-6.89+3) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;dissociation coefficient for acid chains of subunit&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Types.Concentration</a> Kz = 10^(-7.25+3) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;valine 1 amino terminus dissociation coefficient of protonation to NH3+&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Types.Concentration</a> Kc = 10^(-8.35+3) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;valine 1 amino terminus dissociation coefficient of protonation to NH3+&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Types.Concentration</a> KO2 = 0.000671946 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;oxygen dissociation coefficient of hemoglobin subunit&quot;</span>;

  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.Speciation"
>Components.Speciation</a> Speciation(NumberOfSubunits=12);
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.Substance"
>Components.Substance</a> OxyHm[4](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>solute_start=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>Simulation=Types.SimulationType.SteadyState,
    isDependent={isDependent,true,true,true}) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;Oxygenated subunit of hemoglobin tetramer&quot;</span>;
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.ChemicalReaction"
>Components.ChemicalReaction</a> oxygenation1[4](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>nP=2, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>K=KO2);
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.Substance"
>Components.Substance</a> DeoxyHm[4](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>Simulation=Types.SimulationType.SteadyState,
      <span style="color: blue; font-weight: normal; font-style: normal;">each </span>solute_start=1e-08) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Deoxygenated subunit of hemoglobin tetramer&quot;</span>;

  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Add"
>Modelica.Blocks.Math.Add</a> add[4];
  <a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>Interfaces.ChemicalPort_a</a> O2;
  <a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>Interfaces.ChemicalPort_a</a> sForm;
  <a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>Interfaces.ChemicalPort_a</a> H <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;hydrogen ion (proton)&quot;</span>;
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.Substance"
>Components.Substance</a> A[4](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>Simulation=Types.SimulationType.SteadyState,
      <span style="color: blue; font-weight: normal; font-style: normal;">each </span>solute_start=1e-08) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;residual acid chains of hemoglobin subunits &quot;</span>;
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.Substance"
>Components.Substance</a> HA[4](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>solute_start=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>Simulation=Types.SimulationType.SteadyState,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>isDependent=true) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;residual acid chains of hemoglobin subunits &quot;</span>;
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.ChemicalReaction"
>Components.ChemicalReaction</a> protonation1[4](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>nP=2, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>K=KA);
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Add"
>Modelica.Blocks.Math.Add</a> add1[
                               4];
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.Substance"
>Components.Substance</a> NH2[4](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>Simulation=Types.SimulationType.SteadyState,
      <span style="color: blue; font-weight: normal; font-style: normal;">each </span>solute_start=1e-08) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Val1 terminal of hemoglobin subunits &quot;</span>;
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.Substance"
>Components.Substance</a> NH3[4](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>solute_start=0,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>Simulation=Types.SimulationType.SteadyState,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>isDependent=true) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Val1 terminal of hemoglobin subunits &quot;</span>;
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.ChemicalReaction"
>Components.ChemicalReaction</a> protonation2[4](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>nP=2, <span style="color: blue; font-weight: normal; font-style: normal;">each </span>K=Kz);
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Add3"
>Modelica.Blocks.Math.Add3</a> add2[
                               4];
  <a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>Interfaces.ChemicalPort_a</a> CO2;
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.ChemicalReaction"
>Components.ChemicalReaction</a> carboxylation[4](
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nP=2,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>nS=2,
    <span style="color: blue; font-weight: normal; font-style: normal;">each </span>K=Kc) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Carboxylation of Valin1 amino terminus of hemogloni subunit&quot;</span>;
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.Substance"
>Components.Substance</a> NHCOO[4](<span style="color: blue; font-weight: normal; font-style: normal;">each </span>Simulation=Types.SimulationType.SteadyState,
      <span style="color: blue; font-weight: normal; font-style: normal;">each </span>solute_start=1e-08) <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Val1 terminal of hemoglobin subunits &quot;</span>;
  <a href="Physiolibrary_Types_RealIO.html#Physiolibrary.Types.RealIO.AmountOfSubstanceOutput"
>Types.RealIO.AmountOfSubstanceOutput</a> tAmount(start=1e-08);
  <a href="Physiolibrary_Types_RealIO.html#Physiolibrary.Types.RealIO.AmountOfSubstanceOutput"
>Types.RealIO.AmountOfSubstanceOutput</a> protonation;
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Sum"
>Modelica.Blocks.Math.Sum</a> add3(k=<span style="color: red; font-weight: normal; font-style: normal;">cat</span>(
        1,
        -<span style="color: red; font-weight: normal; font-style: normal;">ones</span>(4),
        <span style="color: red; font-weight: normal; font-style: normal;">ones</span>(8)), nin=12);
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Sum"
>Modelica.Blocks.Math.Sum</a> add4(nin=4);
  <a href="Physiolibrary_Types_RealIO.html#Physiolibrary.Types.RealIO.AmountOfSubstanceOutput"
>Types.RealIO.AmountOfSubstanceOutput</a> oxygenation;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(OxyHm.solute, add.u2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(DeoxyHm.solute, add.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(OxyHm.q_out, oxygenation1.substrates[1]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(oxygenation1.products[1], DeoxyHm.q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(Speciation.specificForm, sForm);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(oxygenation1[1].products[2], O2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(oxygenation1[2].products[2], O2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(oxygenation1[3].products[2], O2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(oxygenation1[4].products[2], O2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HA.q_out, protonation1.substrates[1]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(protonation1.products[1], A.q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(H, protonation1[1].products[2]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(protonation1[2].products[2], H);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(protonation1[3].products[2], H);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(protonation1[4].products[2], H);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HA.solute, add1.u2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(A.solute, add1.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(DeoxyHm.q_out, Speciation.specificSubunitForm[1:4]);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(A.q_out, Speciation.specificSubunitForm[5:8]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(add.y, Speciation.amountOfSubunit[1:4]);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(add1.y, Speciation.amountOfSubunit[5:8]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(NH3.q_out, protonation2.substrates[1]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(protonation2.products[1], NH2.q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(H, protonation2[1].products[2]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(protonation2[2].products[2], H);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(protonation2[3].products[2], H);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(protonation2[4].products[2], H);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(add2.y, Speciation.amountOfSubunit[9:12]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(NH2.q_out, Speciation.specificSubunitForm[9:12]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(NH2.q_out, carboxylation.substrates[1]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(carboxylation.products[1], NHCOO.q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(carboxylation[1].products[2], H);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(carboxylation[1].substrates[2], CO2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(carboxylation[2].products[2], H);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(carboxylation[2].substrates[2], CO2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(carboxylation[3].products[2], H);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(carboxylation[3].substrates[2], CO2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(carboxylation[4].products[2], H);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(carboxylation[4].substrates[2], CO2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(NH3.solute, add2.u3);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(NH2.solute, add2.u2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(NHCOO.solute, add2.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(Speciation.amount, tAmount);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(HA.solute, add3.u[9:12]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(NH3.solute, add3.u[5:8]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(NHCOO.solute, add3.u[1:4]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(add3.y, protonation);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(OxyHm.solute, add4.u);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(add4.y, oxygenation);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>QuaternaryForm;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Hemoglobin2<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Chemical.Exad26898b5f385b97obin2I.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin2" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin2"></a><a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop"
>Physiolibrary.Chemical.Examples.Hemoglobin.Develop</a>.Hemoglobin2</h2>
<p>
<b>Hemoglobin model</b>
<br>
<br><img src="Physiolibrary.Chemical.Exad26898b5f385b97obin2D.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin2">
</p>
<h3>Information</h3>

<p>[1] Monod J, Wyman J, Changeux J-P. On the nature of allosteric transitions: a plausible model. Journal of Molecular Biology 1965;12:88-118.</p>

<p>Extends from <a href="Physiolibrary_SteadyStates_Interfaces.html#Physiolibrary.SteadyStates.Interfaces.SteadyStateSystem"
>SteadyStates.Interfaces.SteadyStateSystem</a> (Global abstract class, for additional global state equations).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Fraction"
>Fraction</a></td><td>L</td><td>7.0529*10^6</td><td>=[T0]/[R0] .. dissociation constant of relaxed &lt;-&gt; tensed change of deoxyhemoglobin tetramer [1]</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Fraction"
>Fraction</a></td><td>Ln</td><td>26884.8</td><td>quaternaly form ratio for specific stripped species of hemoglobin tetramer [1]</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Fraction"
>Fraction</a></td><td>c</td><td>0.00431555</td><td>=KR/KT .. ration between oxygen affinities of relaxed vs. tensed subunit [1]</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Concentration</a></td><td>KR</td><td>0.000671946</td><td>oxygen dissociation on relaxed(R) hemoglobin subunit [mol/m3]</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Concentration</a></td><td>KT</td><td>KR/c</td><td>oxygen dissociation on tensed(T) hemoglobin subunit [mol/m3]</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.AmountOfSubstance"
>AmountOfSubstance</a></td><td>totalAmountOfHemoglobin</td><td>0.001</td><td>[mol]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Simulation</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Simulation type</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.SimulationType"
>SimulationType</a></td><td>Simulation</td><td>Types.SimulationType.SteadyS...</td><td>Dynamic with Initialization or Steady State</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equilibrium</td></tr>
<tr><td>Integer</td><td>NumberOfDependentStates</td><td>1</td><td>Number of additional steady state equation of the system</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td><a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>ChemicalPort_a</a></td><td>H</td><td>H+ (proton)</td></tr>
<tr><td><a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>ChemicalPort_a</a></td><td>CO2</td><td>carbon dioxide</td></tr>
<tr><td><a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>ChemicalPort_a</a></td><td>O2</td><td>oxygen</td></tr>
<tr><td>output <a href="Physiolibrary_Types_RealIO.html#Physiolibrary.Types.RealIO.FractionOutput"
>FractionOutput</a></td><td>protonation</td><td>[1]</td></tr>
<tr><td>output <a href="Physiolibrary_Types_RealIO.html#Physiolibrary.Types.RealIO.FractionOutput"
>FractionOutput</a></td><td>sO2</td><td>[1]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> Hemoglobin2 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Hemoglobin model&quot;</span>

 <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Physiolibrary_SteadyStates_Interfaces.html#Physiolibrary.SteadyStates.Interfaces.SteadyStateSystem"
>SteadyStates.Interfaces.SteadyStateSystem</a>(
                                          Simulation=Types.SimulationType.SteadyState);

<span style="color: #006400; font-weight: normal; font-style: normal;">//  parameter GasSolubility alpha =  0.0105 * 1e-3 &quot;oxygen solubility in plasma&quot;;   // by Siggaard Andersen: 0.0105 (mmol/l)/kPa</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Fraction"
>Types.Fraction</a> L = 7.0529*10^6 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;=[T0]/[R0] .. dissociation constant of relaxed &lt;-&gt; tensed change of deoxyhemoglobin tetramer&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Fraction"
>Types.Fraction</a> Ln = 26884.8 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;quaternaly form ratio for specific stripped species of hemoglobin tetramer&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">                               //L*0.00381188                                                                     //&quot;=L*(fnT/fnR)^4 for pH=7.2464 and CO2=0&quot;;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Fraction"
>Types.Fraction</a> c = 0.00431555 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;=KR/KT .. ration between oxygen affinities of relaxed vs. tensed subunit&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Types.Concentration</a> KR = 0.000671946 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;oxygen dissociation on relaxed(R) hemoglobin subunit&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">                                                            //*7.875647668393782383419689119171e-5</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">                                                          //10.500001495896 7.8756465463794e-05</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Types.Concentration</a> KT=KR/c <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;oxygen dissociation on tensed(T) hemoglobin subunit&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.AmountOfSubstance"
>Types.AmountOfSubstance</a> totalAmountOfHemoglobin=0.001;

  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.ChemicalReaction"
>Components.ChemicalReaction</a> quaternaryForm(K=Ln);

  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.QuaternaryForm"
>QuaternaryForm</a> R(
    KO2=KR,
    KA=10^(-6.89 + 3),
    Kz=10^(-7.25 + 3),
    Kc=10^(-8.35 + 3),
    isDependent=true);
  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.QuaternaryForm"
>QuaternaryForm</a> T(
    KO2=KT,
    KA=10^(-7.52 + 3),
    Kz=10^(-7.73 + 3),
    Kc=10^(-7.54 + 3));
  <a href="Physiolibrary_SteadyStates_Components.html#Physiolibrary.SteadyStates.Components.MolarConservationLaw"
>SteadyStates.Components.MolarConservationLaw</a> totalHb(
    n=2,
    Total=totalAmountOfHemoglobin,
    Simulation=Types.SimulationType.SteadyState);
  <a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>Interfaces.ChemicalPort_a</a> H <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;H+ (proton)&quot;</span>;
  <a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>Interfaces.ChemicalPort_a</a> CO2 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;carbon dioxide&quot;</span>;
  <a href="Physiolibrary_Chemical_Interfaces.html#Physiolibrary.Chemical.Interfaces.ChemicalPort_a"
>Interfaces.ChemicalPort_a</a> O2 <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;oxygen&quot;</span>;
  <a href="Physiolibrary_Types_RealIO.html#Physiolibrary.Types.RealIO.FractionOutput"
>Types.RealIO.FractionOutput</a>          protonation;
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Add"
>Modelica.Blocks.Math.Add</a> add(k1=1/4, k2=1/4);
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Division"
>Modelica.Blocks.Math.Division</a> division;
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Add"
>Modelica.Blocks.Math.Add</a> add1(
                               k1=1/4, k2=1/4);
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Division"
>Modelica.Blocks.Math.Division</a> division1;
  <a href="Physiolibrary_Types_RealIO.html#Physiolibrary.Types.RealIO.FractionOutput"
>Types.RealIO.FractionOutput</a> sO2;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(R.CO2, CO2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(CO2, T.CO2);

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(R.O2, O2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(R.H, H);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(R.sForm, quaternaryForm.substrates[1]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(T.O2, O2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(T.H, H);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(T.sForm, quaternaryForm.products[1]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(R.tAmount, totalHb.fragment[1]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(T.tAmount, totalHb.fragment[2]);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(T.protonation, add.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(R.protonation, add.u2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(division.u2, totalHb.totalAmountOfSubstance);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(division.u1, add.y);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(protonation, division.y);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(division1.u1, add1.y);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(R.oxygenation, add1.u2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(T.oxygenation, add1.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(totalHb.totalAmountOfSubstance, division1.u2);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(division1.y, sO2);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>Hemoglobin2;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Hemoglobin_oxygenation<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Chemical.Exa0f7da7d66b9af82ationI.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_oxygenation" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_oxygenation"></a><a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop"
>Physiolibrary.Chemical.Examples.Hemoglobin.Develop</a>.Hemoglobin_oxygenation</h2>
<p>
<b>Hemoglobin oxygenation experiment</b>
<br>
<br><img src="Physiolibrary.Chemical.Exa0f7da7d66b9af82ationD.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_oxygenation">
</p>
<h3>Information</h3>

<p>[1] Severinghaus JW. Simple, accurate equations for human blood O2 dissociation computations. Journal of Applied Physiology 1979;46:599-602.</p>

<p>Extends from <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a> (Icon for runnable examples).</p>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> Hemoglobin_oxygenation <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Hemoglobin oxygenation experiment&quot;</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">import </span><a href="Physiolibrary_Types.html#Physiolibrary.Types"
>Physiolibrary.Types</a>.*;

 <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a>;

  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.Substance"
>Components.Substance</a> oxygen_unbound(Simulation=SimulationType.SteadyState,
      solute_start=0.000001*7.875647668393782383419689119171e-5);
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Clock"
>Modelica.Blocks.Sources.Clock</a> clock(offset=1e-06);
  <a href="Physiolibrary_Chemical_Sources.html#Physiolibrary.Chemical.Sources.UnlimitedGasStorage"
>Sources.UnlimitedGasStorage</a> oxygen_in_air(
    Simulation=Types.SimulationType.SteadyState,
    usePartialPressureInput=true,
    T=310.15,
    isIsolatedInSteadyState=false);
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.GasSolubility"
>Components.GasSolubility</a> partialPressure1(
    kH_T0(displayUnit=&quot;(mmol/l)/kPa at 25degC&quot;) = 0.026029047188736,
    T=310.15,
    C=1700);
  <a href="Physiolibrary_Chemical_Sources.html#Physiolibrary.Chemical.Sources.UnlimitedSolutionStorage"
>Sources.UnlimitedSolutionStorage</a> pH(
    q_out(conc(nominal=10^(-7.4 + 3))),
    Simulation=Types.SimulationType.SteadyState,
    Conc=10^(-7.2464 + 3),
    isIsolatedInSteadyState=false);
  <a href="Physiolibrary_Chemical_Sources.html#Physiolibrary.Chemical.Sources.UnlimitedGasStorage"
>Sources.UnlimitedGasStorage</a> CO2_gas(Simulation=Types.SimulationType.SteadyState,
      PartialPressure=5332.8954966);
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.GasSolubility"
>Components.GasSolubility</a> gasSolubility(C=2400, kH_T0(displayUnit=
          &quot;(mmol/l)/kPa at 25degC&quot;) = 0.81805576878885);
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.Substance"
>Components.Substance</a> CO2_liquid(Simulation=Types.SimulationType.SteadyState,
      isDependent=true);
  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin2"
>Hemoglobin2</a> hemoglobin;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(partialPressure1.q_out, oxygen_in_air.q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(partialPressure1.q_in, oxygen_unbound.q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(clock.y, oxygen_in_air.partialPressure);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(gasSolubility.q_in,CO2_liquid. q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(CO2_gas.q_out,gasSolubility. q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(hemoglobin.CO2, CO2_liquid.q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(hemoglobin.H, pH.q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(hemoglobin.O2, oxygen_unbound.q_out);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>Hemoglobin_oxygenation;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Hemoglobin_titration<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Chemical.Exe7147a02e95496f4ationI.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration"></a><a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop"
>Physiolibrary.Chemical.Examples.Hemoglobin.Develop</a>.Hemoglobin_titration</h2>
<p>
<b>Hemoglobin titration experiment</b>
<br>
<br><img src="Physiolibrary.Chemical.Exe7147a02e95496f4ationD.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration">
</p>
<h3>Information</h3>

<p>[1] Siggaard-Andersen O, Garby L. The Bohr effect and the Haldane effect. Scandinavian Journal of Clinical &AMP; Laboratory Investigation 1973;31:1-8.</p>

<p>Extends from <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a> (Icon for runnable examples), <a href="Physiolibrary_SteadyStates_Interfaces.html#Physiolibrary.SteadyStates.Interfaces.SteadyStateSystem"
>SteadyStates.Interfaces.SteadyStateSystem</a> (Global abstract class, for additional global state equations).</p>
<h3>Parameters</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Parameters">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Fraction"
>Fraction</a></td><td>L</td><td>7.0529*10^6</td><td>=[T0]/[R0] .. dissociation constant of relaxed &lt;-&gt; tensed change of deoxyhemoglobin tetramer [1]</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Fraction"
>Fraction</a></td><td>Ln</td><td>26884.8</td><td>quaternaly form ratio for specific stripped species of hemoglobin tetramer [1]</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Fraction"
>Fraction</a></td><td>c</td><td>0.00431555</td><td>=KR/KT .. ration between oxygen affinities of relaxed vs. tensed subunit [1]</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Concentration</a></td><td>KR</td><td>0.000671946</td><td>oxygen dissociation on relaxed(R) hemoglobin subunit [mol/m3]</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Concentration</a></td><td>KT</td><td>KR/c</td><td>oxygen dissociation on tensed(T) hemoglobin subunit [mol/m3]</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.AmountOfSubstance"
>AmountOfSubstance</a></td><td>totalAmountOfHemoglobin</td><td>0.001</td><td>[mol]</td></tr>
<tr style="background-color: #c0c0c0"><td colspan="4"><b>Simulation</b></td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Simulation type</td></tr>
<tr><td><a href="Physiolibrary_Types.html#Physiolibrary.Types.SimulationType"
>SimulationType</a></td><td>Simulation</td><td>SimulationType.SteadyState</td><td>Dynamic with Initialization or Steady State</td></tr>
<tr style="background-color: #e0e0e0"><td colspan="4">Equilibrium</td></tr>
<tr><td>Integer</td><td>NumberOfDependentStates</td><td>1</td><td>Number of additional steady state equation of the system</td></tr>
</table>
<h3>Connectors</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Connectors">
<tr><th>Type</th><th>Name</th><th>Description</th></tr>
<tr><td>output <a href="Physiolibrary_Types_RealIO.html#Physiolibrary.Types.RealIO.FractionOutput"
>FractionOutput</a></td><td>protonation</td><td>allosteric-dependent protonation [1]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> Hemoglobin_titration <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;Hemoglobin titration experiment&quot;</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">import </span><a href="Physiolibrary_Types.html#Physiolibrary.Types"
>Physiolibrary.Types</a>.*;

 <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a>;

 <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="Physiolibrary_SteadyStates_Interfaces.html#Physiolibrary.SteadyStates.Interfaces.SteadyStateSystem"
>SteadyStates.Interfaces.SteadyStateSystem</a>(
                                          Simulation=SimulationType.SteadyState);

<span style="color: #006400; font-weight: normal; font-style: normal;">//  parameter GasSolubility alpha =  0.0105 * 1e-3 &quot;oxygen solubility in plasma&quot;;   // by Siggaard Andersen: 0.0105 (mmol/l)/kPa</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Fraction"
>Fraction</a> L = 7.0529*10^6 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;=[T0]/[R0] .. dissociation constant of relaxed &lt;-&gt; tensed change of deoxyhemoglobin tetramer&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Fraction"
>Fraction</a> Ln = 26884.8 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;quaternaly form ratio for specific stripped species of hemoglobin tetramer&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">                               //L*0.00381188                                                                     //&quot;=L*(fnT/fnR)^4 for pH=7.2464 and CO2=0&quot;;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Fraction"
>Fraction</a> c = 0.00431555 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;=KR/KT .. ration between oxygen affinities of relaxed vs. tensed subunit&quot;</span>;
  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Concentration</a> KR = 0.000671946 <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;oxygen dissociation on relaxed(R) hemoglobin subunit&quot;</span>;
  <span style="color: #006400; font-weight: normal; font-style: normal;">                                                            //*7.875647668393782383419689119171e-5</span>
  <span style="color: #006400; font-weight: normal; font-style: normal;">                                                          //10.500001495896 7.8756465463794e-05</span>

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.Concentration"
>Concentration</a> KT=KR/c <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;oxygen dissociation on tensed(T) hemoglobin subunit&quot;</span>;

  <span style="color: blue; font-weight: normal; font-style: normal;">parameter </span><a href="Physiolibrary_Types.html#Physiolibrary.Types.AmountOfSubstance"
>AmountOfSubstance</a> totalAmountOfHemoglobin=0.001;

  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.Substance"
>Components.Substance</a> oxygen_unbound(Simulation=SimulationType.SteadyState,
      solute_start=0.000001*7.875647668393782383419689119171e-5);
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Sources.html#Modelica.Blocks.Sources.Clock"
>Modelica.Blocks.Sources.Clock</a> clock(offset=6.7);
  <a href="Physiolibrary_Chemical_Sources.html#Physiolibrary.Chemical.Sources.UnlimitedGasStorage"
>Sources.UnlimitedGasStorage</a> oxygen_in_air(
    Simulation=Types.SimulationType.SteadyState,
    usePartialPressureInput=false,
    PartialPressure=0,
    T=310.15,
    isIsolatedInSteadyState=false);
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.GasSolubility"
>Components.GasSolubility</a> partialPressure1(
    kH_T0(displayUnit=&quot;(mmol/l)/kPa at 25degC&quot;) = 0.024913516594933,
    T=310.15,
    C=1700);
  <a href="Physiolibrary_Chemical_Sources.html#Physiolibrary.Chemical.Sources.UnlimitedSolutionStorage"
>Sources.UnlimitedSolutionStorage</a> pH(
    q_out(conc(nominal=10^(-7.4 + 3))),
    isIsolatedInSteadyState=false,
    Simulation=Types.SimulationType.SteadyState,
    Conc=10^(-7.2464 + 3),
    useConcentrationInput=true);
  <a href="Physiolibrary_Chemical_Sources.html#Physiolibrary.Chemical.Sources.UnlimitedGasStorage"
>Sources.UnlimitedGasStorage</a> CO2_gas(
    Simulation=Types.SimulationType.SteadyState,
    usePartialPressureInput=false,
    PartialPressure=0);
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.GasSolubility"
>Components.GasSolubility</a> gasSolubility(C=2400, kH_T0(displayUnit=
          &quot;(mmol/l)/kPa at 25degC&quot;) = 0.81805576878885);
  <a href="Physiolibrary_Chemical_Components.html#Physiolibrary.Chemical.Components.Substance"
>Components.Substance</a> CO2_liquid(Simulation=Types.SimulationType.SteadyState,
      isDependent=true);
  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin2"
>Hemoglobin2</a> deoxyhemoglobin;
  <a href="Physiolibrary_Types_RealIO.html#Physiolibrary.Types.RealIO.FractionOutput"
>Types.RealIO.FractionOutput</a> protonation <span style="color: #006400; font-weight: normal; font-style: normal;">&quot;allosteric-dependent protonation&quot;</span>;
  <a href="Physiolibrary_Blocks_Math.html#Physiolibrary.Blocks.Math.Power"
>Blocks.Math.Power</a> pow;
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Gain"
>Modelica.Blocks.Math.Gain</a> gain(k=-1);
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Gain"
>Modelica.Blocks.Math.Gain</a> toMolPerM3(k=1000) <span style="color: #006400; font-weight: normal; font-style: normal;">
    &quot;from mol/liter to mmol/liter (=mol/m3)&quot;</span>;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>

  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(partialPressure1.q_out, oxygen_in_air.q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(partialPressure1.q_in, oxygen_unbound.q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(gasSolubility.q_in,CO2_liquid. q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(CO2_gas.q_out,gasSolubility. q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(deoxyhemoglobin.CO2, CO2_liquid.q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(clock.y, gain.u);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(gain.y, pow.exponent);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(pH.concentration, toMolPerM3.y);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(toMolPerM3.u, pow.y);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(deoxyhemoglobin.H, pH.q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(deoxyhemoglobin.O2, oxygen_unbound.q_out);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(deoxyhemoglobin.protonation, protonation);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>Hemoglobin_titration;
</div>
<hr>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE Hemoglobin_titration_shifts<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Chemical.Ex94a14f266a11a303hiftsI.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration_shifts" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration_shifts"></a><a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop"
>Physiolibrary.Chemical.Examples.Hemoglobin.Develop</a>.Hemoglobin_titration_shifts</h2>
<p>
<b>Hemoglobin titration shift caused by full deoxygenation (Bohr protons binding)</b>
<br>
<br><img src="Physiolibrary.Chemical.Ex94a14f266a11a303hiftsD.png" alt="Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration_shifts">
</p>
<h3>Information</h3>

<p>[1] Siggaard-Andersen O. Oxygen-Linked Hydrogen Ion Binding of Human Hemoglobin. Effects of Carbon Dioxide and 2, 3-Diphosphoglycerate I. Studies on Erythrolysate. Scandinavian Journal of Clinical &AMP; Laboratory Investigation 1971;27:351-60.</p>

<p>Extends from <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a> (Icon for runnable examples).</p>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue; font-weight: normal; font-style: normal;">model</span> Hemoglobin_titration_shifts <span style="color: #006400; font-weight: normal; font-style: normal;">
  &quot;Hemoglobin titration shift caused by full deoxygenation (Bohr protons binding)&quot;</span>
  <span style="color: blue; font-weight: normal; font-style: normal;">extends </span><a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Icons.html#Modelica.Icons.Example"
>Modelica.Icons.Example</a>;

  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration"
>Hemoglobin_titration</a> hemoglobin_titration;
  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration"
>Hemoglobin_titration</a> hemoglobin_titration1(CO2_gas(PartialPressure(
          displayUnit=&quot;kPa&quot;) = 1470));
  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration"
>Hemoglobin_titration</a> hemoglobin_titration2(CO2_gas(PartialPressure(
          displayUnit=&quot;kPa&quot;) = 4530));
  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration"
>Hemoglobin_titration</a> hemoglobin_titration3(CO2_gas(PartialPressure(
          displayUnit=&quot;kPa&quot;) = 10670));
  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration"
>Hemoglobin_titration</a> hemoglobin_titration4(CO2_gas(PartialPressure(
          displayUnit=&quot;kPa&quot;) = 26660));
  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration"
>Hemoglobin_titration</a> hemoglobin_titration5(oxygen_in_air(
        PartialPressure=19998.35811225));
  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration"
>Hemoglobin_titration</a> hemoglobin_titration6(oxygen_in_air(
        PartialPressure=19998.35811225), CO2_gas(PartialPressure(
          displayUnit=&quot;kPa&quot;) = 1470));
  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration"
>Hemoglobin_titration</a> hemoglobin_titration7(oxygen_in_air(
        PartialPressure=19998.35811225), CO2_gas(PartialPressure(
          displayUnit=&quot;kPa&quot;) = 4530));
  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration"
>Hemoglobin_titration</a> hemoglobin_titration8(oxygen_in_air(
        PartialPressure=19998.35811225), CO2_gas(PartialPressure(
          displayUnit=&quot;kPa&quot;) = 10670));
  <a href="Physiolibrary_Chemical_Examples_Hemoglobin_Develop.html#Physiolibrary.Chemical.Examples.Hemoglobin.Develop.Hemoglobin_titration"
>Hemoglobin_titration</a> hemoglobin_titration9(oxygen_in_air(
        PartialPressure=19998.35811225), CO2_gas(PartialPressure(
          displayUnit=&quot;kPa&quot;) = 26660));
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Feedback"
>Modelica.Blocks.Math.Feedback</a> dH;
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Feedback"
>Modelica.Blocks.Math.Feedback</a> dH1;
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Feedback"
>Modelica.Blocks.Math.Feedback</a> dH2;
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Feedback"
>Modelica.Blocks.Math.Feedback</a> dH3;
  <a href="file:///C:/Program%20Files%20(x86)/Dymola%202015%20FD01/Modelica/Library/Modelica%203.2.1/help/Modelica_Blocks_Math.html#Modelica.Blocks.Math.Feedback"
>Modelica.Blocks.Math.Feedback</a> dH4;
<span style="color: blue; font-weight: normal; font-style: normal;">equation </span>
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(hemoglobin_titration.protonation, dH.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(dH.u2, hemoglobin_titration5.protonation);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(hemoglobin_titration1.protonation, dH1.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(dH1.u2, hemoglobin_titration6.protonation);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(dH2.u2, hemoglobin_titration7.protonation);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(hemoglobin_titration2.protonation, dH2.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(hemoglobin_titration3.protonation, dH3.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(dH3.u2, hemoglobin_titration8.protonation);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(hemoglobin_titration4.protonation, dH4.u1);
  <span style="color: red; font-weight: normal; font-style: normal;">connect</span>(dH4.u2, hemoglobin_titration9.protonation);
<span style="color: blue; font-weight: normal; font-style: normal;">end </span>Hemoglobin_titration_shifts;
</div>
<hr>
<address>
<a href="http://www.3ds.com/">Automatically generated</a> Tue Sep 15 22:56:03 2015.
</address>
</body>
</html>
