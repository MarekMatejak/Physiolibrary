<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Physiolibrary.Types.FilesUtilities</title>
<meta name="HTML-Generator" content="Dymola">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="&quot;File input/output/test&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial, sans-serif; }
.modelica, .modelica * { font-size: 9pt; font-family: Courier, monospace; white-space: pre; }
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address { font-weight: normal; }
td      { border: 1px solid #808080; vertical-align: top; }
th      { border: 1px solid #808080; vertical-align: top; font-weight: bold; }
table   { border: 1px solid #808080; border-collapse: collapse; }
</style>
</head>
<body>
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE FilesUtilities<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><a name="Physiolibrary.Types.FilesUtilities"></a><a href="Physiolibrary_Types.html#Physiolibrary.Types"
>Physiolibrary.Types</a>.FilesUtilities</h2>
<p>
<b>File input/output/test</b><br>
</p>
<h3>Information</h3>

<p>During the creation and debugging of huge integrated models it is necessary to easily define consistent input, output and test sets of all output variables for some subsystems. Let&apos;s imagine that we have a model composed only of subsystems that converge from some constant inputs to constant outputs. It should be possible to substitute each main subsystem for its chosen constant output values as parameters. Comparing the model with these parametric values and the original subsystem can show the wrong part of the simulation. </p>
<p>For example in the huge HumMod model it is necessary to debug smaller parts separately. These tools could be use, because HumMod is the type of constant-converged model. Each subsystem in the first level has the constant input values set for its output variables. Simulating, for example, the cardiovascular subsystem is possible by creating the high-level system with the original cardiovascular subsystem, but with a constant metabolic, constant thermoregulation, constant hormonal, constant water, constant proteins, constant gases, constant electrolytes and constant status subsystem. </p>
<p>Because the number of output variables for each subsytem changes during development, it is a good idea to have only one list for each subsystem. And generating consistent sets to store, restore, compare initial and final values is possible by the same pattern as presented in the package Types.Example. In this package it is also possible to define a customized &nbsp;way to save and load the variables that connect subsystems together. For this purpose, one has to redeclare the package Types.Utilities with simple functions for reading and writing values, such as is done in the default package FileUtilities. </p>

<p>Extends from <a href="Physiolibrary_Types_Utilities.html#Physiolibrary.Types.Utilities"
>Types.Utilities</a> (Value input/output/test support), Modelica.Icons.VariantsPackage (Icon for package containing variants).</p>
<h3>Package Content</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Package Content">
<tr>
<th>Name</th>
<th>Description</th>
</tr>
<tr>
<td>directoryName=&quot;io&quot;</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>inputFileName=&quot;input.txt&quot;</td>
<td>File to load values with (non-)SI units</td>
</tr>
<tr>
<td>outputFileName=&quot;output.txt&quot;</td>
<td>File to save values with (non-)SI units</td>
</tr>
<tr>
<td>comparisonFileName=&quot;comparison.txt&quot;</td>
<td>File to save comparison from loaded values and simulation results with (non-)SI units</td>
</tr>
<tr>
<td>inputSIFileName=&quot;input_SI.txt&quot;</td>
<td>File to load values in SI units</td>
</tr>
<tr>
<td>outputSIFileName=&quot;output_SI.txt&quot;</td>
<td>File to save values in SI units</td>
</tr>
<tr>
<td>comparisonSIFileName=&quot;comparison_SI.txt&quot;</td>
<td>File to save comparison in SI units from loaded values and simulation results</td>
</tr>
<tr>
<td><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealS.png" alt="Physiolibrary.Types.FilesUtilities.readReal" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities.readReal"
>readReal</a>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealS.png" alt="Physiolibrary.Types.FilesUtilities.readReal_SI" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities.readReal_SI"
>readReal_SI</a>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealS.png" alt="Physiolibrary.Types.FilesUtilities.readBoolean" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities.readBoolean"
>readBoolean</a>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealS.png" alt="Physiolibrary.Types.FilesUtilities.writeReal" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities.writeReal"
>writeReal</a>
</td>
<td>Write the value to file</td>
</tr>
<tr>
<td><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealS.png" alt="Physiolibrary.Types.FilesUtilities.writeReal_SI" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities.writeReal_SI"
>writeReal_SI</a>
</td>
<td>Write the value to file using SI unit</td>
</tr>
<tr>
<td><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealS.png" alt="Physiolibrary.Types.FilesUtilities.writeBoolean" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities.writeBoolean"
>writeBoolean</a>
</td>
<td>&nbsp;</td>
</tr>
<tr>
<td><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealS.png" alt="Physiolibrary.Types.FilesUtilities.writeComparison" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities.writeComparison"
>writeComparison</a>
</td>
<td>Compare and write the result and the value to file</td>
</tr>
<tr>
<td><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealS.png" alt="Physiolibrary.Types.FilesUtilities.writeComparison_SI" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities.writeComparison_SI"
>writeComparison_SI</a>
</td>
<td>Compare and write the result and the value to file using SI units</td>
</tr>
<tr>
<td><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealS.png" alt="Physiolibrary.Types.FilesUtilities.writeBooleanComparison" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities.writeBooleanComparison"
>writeBooleanComparison</a>
</td>
<td>Compare and write the result and the value to file</td>
</tr>
<tr>
<th colspan="2">Inherited</th>
</tr>
<tr>
<td><img src="Physiolibrary.Types.Utili2c592c35b26bf466sionsS.png" alt="Physiolibrary.Types.Utilities.UnitConversions" width="20" height="20" align="top">&nbsp;<a href="Physiolibrary_Types_Utilities_UnitConversions.html#Physiolibrary.Types.Utilities.UnitConversions"
>UnitConversions</a>
</td>
<td>Conversions non-SI units at input/output</td>
</tr>
</table>
<h3>Revisions</h3>

<p>Licensed by Marek Matejak under the Modelica License 2</p>
<p>Copyright &copy; 2008-2013, Marek Matejak, Charles University in Prague.</p>
<p><br/><i>This Modelica package is&nbsp;<u>free</u>&nbsp;software and the use is completely at&nbsp;<u>your own risk</u>; it can be redistributed and/or modified under the terms of the Modelica License 2. For license conditions (including the disclaimer of warranty) see&nbsp;<a href="Physiolibrary_UsersGuide.html#Physiolibrary.UsersGuide.ModelicaLicense2"
>UsersGuide.ModelicaLicense2</a>&nbsp;or visit&nbsp;<a href="http://www.modelica.org/licenses/ModelicaLicense2">http://www.modelica.org/licenses/ModelicaLicense2</a>.</i></p>

<h3>Types and constants</h3>
<pre>  <span style="color: blue">constant </span>String directoryName=&quot;io&quot;;</pre>
<pre>  <span style="color: blue">constant </span>String inputFileName=&quot;input.txt&quot; <span style="color: #006400">
  &quot;File to load values with (non-)SI units&quot;</span>;</pre>
<pre>  <span style="color: blue">constant </span>String outputFileName=&quot;output.txt&quot; <span style="color: #006400">
  &quot;File to save values with (non-)SI units&quot;</span>;</pre>
<pre>  <span style="color: blue">constant </span>String comparisonFileName=&quot;comparison.txt&quot; <span style="color: #006400">
  &quot;File to save comparison from loaded values and simulation results with (non-)SI units&quot;</span>;</pre>
<pre>  <span style="color: blue">constant </span>String inputSIFileName=&quot;input_SI.txt&quot; <span style="color: #006400">
  &quot;File to load values in SI units&quot;</span>;</pre>
<pre>  <span style="color: blue">constant </span>String outputSIFileName=&quot;output_SI.txt&quot; <span style="color: #006400">
  &quot;File to save values in SI units&quot;</span>;</pre>
<pre>  <span style="color: blue">constant </span>String comparisonSIFileName=&quot;comparison_SI.txt&quot; <span style="color: #006400">
  &quot;File to save comparison in SI units from loaded values and simulation results&quot;</span>;</pre>
<br clear="all" style="page-break-before: always">
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE readReal<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealI.png" alt="Physiolibrary.Types.FilesUtilities.readReal" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Types.FilesUtilities.readReal"></a><a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities"
>Physiolibrary.Types.FilesUtilities</a>.readReal</h2>
<h3>Information</h3>
<p>Extends from <a href="Physiolibrary_Types_Utilities.html#Physiolibrary.Types.Utilities.readReal"
></a> (Read the real value of parameter from file with lines in format:
  &lt;parameterName&gt;
  &lt;value&gt; &lt;unit&gt;).</p>
<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>name</td><td>&nbsp;</td><td>Name of parameter</td></tr>
<tr><td>String</td><td>storeUnit</td><td>&nbsp;</td><td>Prefered units to store variable value</td></tr>
<tr><td><a href="Physiolibrary_Types_Utilities_UnitConversions.html#Physiolibrary.Types.Utilities.UnitConversions.RealTypeRecord"
>RealTypeRecord</a></td><td>unitConversions[:]</td><td>UnitConversions.RealTypeDef</td><td>Unit conversions</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">redeclare </span><span style="color: blue">function</span> <span style="color: blue">extends </span>readReal
  <span style="color: blue">import </span><a href="Modelica_Utilities.html#Modelica.Utilities"
>Modelica.Utilities</a>.*;

<span style="color: blue">protected </span>
  String fn;
  String line;
  Integer nextIndex;
  Integer lineLen;
  Integer iline=1;
  Boolean found = false;
  Boolean endOfFile=false;
  String str;
  Real inputValue;
  Integer typeDef;
<span style="color: blue">algorithm </span>
  fn:=directoryName + &quot;/&quot; + inputFileName;

  <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(fn)<span style="color: blue"> then</span>
    <span style="color: red"> Streams.error</span>(&quot;readRealParameter(\&quot;&quot;+name+&quot;\&quot;, \&quot;&quot;+ fn + &quot;\&quot;)  Error: the file does not exist.\n&quot;);
  <span style="color: blue">else</span>

  typeDef:=<span style="color: red">UnitConversions.findUnit</span>(storeUnit,unitConversions);

  <span style="color: #006400">//Format &quot;&lt;variableName&gt;\n&lt;value&gt; &lt;unit&gt;&quot;</span>
  (line, endOfFile) :=<span style="color: red">Streams.readLine</span>(fn, iline);
  <span style="color: blue">while </span><span style="color: blue">not </span>found<span style="color: blue"> and </span><span style="color: blue">not </span>endOfFile<span style="color: blue"> loop</span>
       <span style="color: blue">if </span>line == name<span style="color: blue"> then</span>
        <span style="color: #006400">   // name found, get value of &quot;name = value;&quot;</span>
           (line, endOfFile) :=<span style="color: red">Streams.readLine</span>(fn, iline+1);
           lineLen :=<span style="color: red"> Strings.length</span>(line);
           nextIndex:=1;

<span style="color: #006400">/*
other wariant: //Format &quot;&lt;variableName&gt;=&lt;value&gt;&lt;unit&gt;&quot;
  while not found and not endOfFile loop
       iline:=iline+1;
       (line, endOfFile) :=Streams.readLine(fn, iline);
       lineLen := Strings.length(line);

       if lineLen&gt;3 then

         nextIndex:=1; //because Coleman does not use the right identifiers, scanIdentifier can not be used :(
         str:=Strings.substring(line,nextIndex,nextIndex);
         while ((nextIndex+1)&lt;lineLen and (not Strings.isEqual(str,&quot; &quot;)) and (not Strings.isEqual(str,&quot;=&quot;)) and (not Strings.isEqual(str,&quot;\t&quot;))) loop
            nextIndex:=nextIndex+1;
            str:=Strings.substring(line,nextIndex,nextIndex);
         end while;
         str := Strings.substring(line,1,nextIndex-1);

         if str==name then

           nextIndex:=Strings.Advanced.skipWhiteSpace(line,nextIndex);
           nextIndex:=Strings.Advanced.skipWhiteSpace(line,nextIndex+1); //skip &#39;=&#39; and white-spaces before/after
*/</span>

           (inputValue,nextIndex) :=<span style="color: red"> Strings.scanReal</span>(line, nextIndex);

           nextIndex:=<span style="color: red">Strings.Advanced.skipWhiteSpace</span>(line,nextIndex);
           <span style="color: blue">if </span>nextIndex&gt;lineLen<span style="color: blue"> then</span>
               <span style="color: blue">if </span><span style="color: red">Strings.length</span>(unitConversions[typeDef].DisplayUnit) &gt; 0<span style="color: blue"> then</span>
            <span style="color: red">     Streams.error</span>(&quot;No units detected for variable &#39;&quot; + name +
                                &quot;&#39; in file &#39;&quot; + fn + &quot;&#39;. Expected unis are &#39;&quot; + unitConversions[typeDef].DisplayUnit + &quot;&#39;!\n&quot;);
               <span style="color: blue">end if</span>;
          <span style="color: #006400">     //Streams.print(&quot; &gt; &quot; + name + &quot;\t &quot; + String(inputValue) + &quot; (no units)&quot;);</span>
           <span style="color: blue">else</span>
               str :=<span style="color: red">Strings.substring</span>(line,<span style="color: red"> Strings.Advanced.skipWhiteSpace</span>(line,nextIndex),<span style="color: red">  Strings.length</span>(line));
               <span style="color: blue">if </span>str &lt;&gt; unitConversions[typeDef].DisplayUnit<span style="color: blue"> then</span>
            <span style="color: red">      Streams.error</span>(&quot;Units &#39;&quot; + str + &quot;&#39; not expected for variable &#39;&quot;
                   + name + &quot;&#39; in file &#39;&quot; + fn + &quot;&#39;. Expected unis are &#39;&quot; +
                  unitConversions[typeDef].DisplayUnit + &quot;&#39;!\n&quot;);
               <span style="color: blue">end if</span>;
          <span style="color: #006400">     //Streams.print(&quot; &gt; &quot; + name + &quot;\t &quot; + String(inputValue) + &quot; &quot; + str);</span>
           <span style="color: blue">end if</span>;
           value :=inputValue*unitConversions[typeDef].Scale + unitConversions[typeDef].Offset;
        <span style="color: #006400">   //Streams.print(&quot;\t\t =&quot; + String(value) + &quot; &quot; + unitConversions[typeDef].Unit);</span>
           found := true;
        <span style="color: #006400">   // end if;  //Format &quot;&lt;variableName&gt;=&lt;value&gt;&lt;unit&gt;&quot;</span>

        <span style="color: #006400">   //Format &quot;&lt;variableName&gt;\n&lt;value&gt;&lt;unit&gt;&quot;</span>
       <span style="color: blue">else</span>
        <span style="color: #006400">   // wrong name, skip lines</span>
           iline := iline + 2;
        <span style="color: #006400">   // read next variable name</span>
           (line, endOfFile) :=<span style="color: red">Streams.readLine</span>(fn, iline);
       <span style="color: blue">end if</span>;
     <span style="color: blue">end while</span>;

     <span style="color: blue">if </span><span style="color: blue">not </span>found<span style="color: blue"> then</span>
      <span style="color: red">  Streams.error</span>(&quot;Parameter \&quot;&quot; + name + &quot;\&quot; not found in file \&quot;&quot; + fn + &quot;\&quot;\n&quot;);
     <span style="color: blue">end if</span>;
   <span style="color: blue">end if</span>;

<span style="color: blue">end </span>readReal;
</div>
<br clear="all" style="page-break-before: always">
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE readReal_SI<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealI.png" alt="Physiolibrary.Types.FilesUtilities.readReal_SI" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Types.FilesUtilities.readReal_SI"></a><a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities"
>Physiolibrary.Types.FilesUtilities</a>.readReal_SI</h2>
<h3>Information</h3>
<p>Extends from <a href="Physiolibrary_Types_Utilities.html#Physiolibrary.Types.Utilities.readReal_SI"
></a> (Read the real value in SI units of parameter from file with lines in format:
  &lt;parameterName&gt;\n&lt;value&gt;).</p>
<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>name</td><td>&nbsp;</td><td>Name of parameter</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">redeclare </span><span style="color: blue">function</span> <span style="color: blue">extends </span>readReal_SI
  <span style="color: blue">import </span><a href="Modelica_Utilities.html#Modelica.Utilities"
>Modelica.Utilities</a>.*;

<span style="color: blue">protected </span>
  String fn;
  String line;
  Integer nextIndex;
  Integer iline=1;
  Boolean found = false;
  Boolean endOfFile=false;

<span style="color: blue">algorithm </span>
  fn:=directoryName + &quot;/&quot; +inputSIFileName;

  <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(fn)<span style="color: blue"> then</span>
    <span style="color: red"> Streams.error</span>(&quot;readRealParameter(\&quot;&quot;+name+&quot;\&quot;, \&quot;&quot;+ fn + &quot;\&quot;)  Error: the file does not exist.\n&quot;);
  <span style="color: blue">else</span>

  <span style="color: #006400">//Format &quot;&lt;variableName&gt;\n&lt;value&gt; &lt;unit&gt;&quot;</span>
  (line, endOfFile) :=<span style="color: red">Streams.readLine</span>(fn, iline);
  <span style="color: blue">while </span><span style="color: blue">not </span>found<span style="color: blue"> and </span><span style="color: blue">not </span>endOfFile<span style="color: blue"> loop</span>
       <span style="color: blue">if </span>line == name<span style="color: blue"> then</span>
        <span style="color: #006400">   // name found, get value of &quot;name = value;&quot;</span>
           (line, endOfFile) :=<span style="color: red">Streams.readLine</span>(fn, iline+1);
           nextIndex:=1;

           (value,nextIndex) :=<span style="color: red"> Strings.scanReal</span>(line, nextIndex);
           found := true;

         <span style="color: blue">else</span>
        <span style="color: #006400"> // wrong name, skip lines</span>
           iline := iline + 2;
        <span style="color: #006400">   // read next variable name</span>
           (line, endOfFile) :=<span style="color: red">Streams.readLine</span>(fn, iline);

         <span style="color: blue">end if</span>;
     <span style="color: blue">end while</span>;

     <span style="color: blue">if </span><span style="color: blue">not </span>found<span style="color: blue"> then</span>
      <span style="color: red">  Streams.error</span>(&quot;Parameter \&quot;&quot; + name + &quot;\&quot; not found in file \&quot;&quot; + fn + &quot;\&quot;\n&quot;);
     <span style="color: blue">end if</span>;
   <span style="color: blue">end if</span>;

<span style="color: blue">end </span>readReal_SI;
</div>
<br clear="all" style="page-break-before: always">
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE readBoolean<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealI.png" alt="Physiolibrary.Types.FilesUtilities.readBoolean" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Types.FilesUtilities.readBoolean"></a><a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities"
>Physiolibrary.Types.FilesUtilities</a>.readBoolean</h2>
<h3>Information</h3>
<p>Extends from <a href="Physiolibrary_Types_Utilities.html#Physiolibrary.Types.Utilities.readBoolean"
></a> (Read the boolean value of parameter from file with lines in format:
  &lt;parameterName&gt;
  &lt;value&gt; &lt;unit&gt;).</p>
<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>name</td><td>&nbsp;</td><td>Variable name</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">redeclare </span><span style="color: blue">function</span> <span style="color: blue">extends </span>readBoolean
  <span style="color: blue">import </span><a href="Modelica_Utilities.html#Modelica.Utilities"
>Modelica.Utilities</a>.*;

<span style="color: blue">algorithm </span>
  value:=(<span style="color: red">readReal</span>(name,&quot;&quot;)&gt;0.005);
<span style="color: blue">end </span>readBoolean;
</div>
<br clear="all" style="page-break-before: always">
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE writeReal<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealI.png" alt="Physiolibrary.Types.FilesUtilities.writeReal" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Types.FilesUtilities.writeReal"></a><a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities"
>Physiolibrary.Types.FilesUtilities</a>.writeReal</h2>
<p>
<b>Write the value to file</b>
</p>
<h3>Information</h3>
<p>Extends from <a href="Physiolibrary_Types_Utilities.html#Physiolibrary.Types.Utilities.writeReal"
></a> (Write the real value to file).</p>
<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>name</td><td>&nbsp;</td><td>Variable name</td></tr>
<tr><td>String</td><td>storeUnit</td><td>&nbsp;</td><td>Prefered units to store variable value</td></tr>
<tr><td><a href="Physiolibrary_Types_Utilities_UnitConversions.html#Physiolibrary.Types.Utilities.UnitConversions.RealTypeRecord"
>RealTypeRecord</a></td><td>unitConversions[:]</td><td>UnitConversions.RealTypeDef</td><td>Unit conversions</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">redeclare </span><span style="color: blue">function</span> <span style="color: blue">extends </span>writeReal <span style="color: #006400">&quot;Write the value to file&quot;</span>
  <span style="color: blue">import </span><a href="Modelica_Utilities.html#Modelica.Utilities"
>Modelica.Utilities</a>.*;

<span style="color: blue">protected </span>
  String fn;
  Integer typeDef <span style="color: #006400">&quot;Variable type&quot;</span>;

<span style="color: blue">algorithm </span>
  fn:=directoryName + &quot;/&quot; +outputFileName;

  <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(fn)<span style="color: blue"> then</span>
     <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(directoryName)<span style="color: blue"> then</span>
      <span style="color: red">   Files.createDirectory</span>(directoryName);
     <span style="color: blue">end if</span>;
  <span style="color: blue">end if</span>;

  typeDef:=<span style="color: red">UnitConversions.findUnit</span>(storeUnit,unitConversions);

  <span style="color: red">Streams.print</span>(name + &quot;\n&quot; +<span style="color: red"> String</span>(((value - unitConversions[typeDef].Offset)/unitConversions[typeDef].Scale))
  + &quot; &quot; + unitConversions[typeDef].DisplayUnit, fn);

<span style="color: blue">end </span>writeReal;
</div>
<br clear="all" style="page-break-before: always">
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE writeReal_SI<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealI.png" alt="Physiolibrary.Types.FilesUtilities.writeReal_SI" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Types.FilesUtilities.writeReal_SI"></a><a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities"
>Physiolibrary.Types.FilesUtilities</a>.writeReal_SI</h2>
<p>
<b>Write the value to file using SI unit</b>
</p>
<h3>Information</h3>
<p>Extends from <a href="Physiolibrary_Types_Utilities.html#Physiolibrary.Types.Utilities.writeReal_SI"
></a> (Write the real value using SI unit to file).</p>
<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>name</td><td>&nbsp;</td><td>Variable name</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">redeclare </span><span style="color: blue">function</span> <span style="color: blue">extends </span>writeReal_SI <span style="color: #006400">
  &quot;Write the value to file using SI unit&quot;</span>
  <span style="color: blue">import </span><a href="Modelica_Utilities.html#Modelica.Utilities"
>Modelica.Utilities</a>.*;

<span style="color: blue">protected </span>
  String fn;
  Integer typeDef <span style="color: #006400">&quot;Variable type&quot;</span>;

<span style="color: blue">algorithm </span>
  fn:=directoryName + &quot;/&quot; +outputSIFileName;

  <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(fn)<span style="color: blue"> then</span>
     <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(directoryName)<span style="color: blue"> then</span>
      <span style="color: red">   Files.createDirectory</span>(directoryName);
     <span style="color: blue">end if</span>;
  <span style="color: blue">end if</span>;

  <span style="color: red"> Streams.print</span>(name + &quot;\n&quot; +<span style="color: red"> String</span>(value), fn);

<span style="color: blue">end </span>writeReal_SI;
</div>
<br clear="all" style="page-break-before: always">
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE writeBoolean<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealI.png" alt="Physiolibrary.Types.FilesUtilities.writeBoolean" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Types.FilesUtilities.writeBoolean"></a><a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities"
>Physiolibrary.Types.FilesUtilities</a>.writeBoolean</h2>
<h3>Information</h3>
<p>Extends from <a href="Physiolibrary_Types_Utilities.html#Physiolibrary.Types.Utilities.writeBoolean"
></a> (Write the boolean value to file).</p>
<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>name</td><td>&nbsp;</td><td>Variable name</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">redeclare </span><span style="color: blue">function</span> <span style="color: blue">extends </span>writeBoolean
  <span style="color: blue">import </span><a href="Modelica_Utilities.html#Modelica.Utilities"
>Modelica.Utilities</a>.*;
<span style="color: blue">protected </span>
  String fn;

<span style="color: blue">algorithm </span>
  fn:=directoryName + &quot;/&quot; +outputFileName;

  <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(fn)<span style="color: blue"> then</span>
     <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(directoryName)<span style="color: blue"> then</span>
      <span style="color: red">   Files.createDirectory</span>(directoryName);
     <span style="color: blue">end if</span>;
  <span style="color: blue">end if</span>;

  <span style="color: red">Streams.print</span>( name + &quot;\n&quot; +<span style="color: red"> String</span>(<span style="color: blue">if </span>value<span style="color: blue"> then </span>1<span style="color: blue"> else </span>0),      fn);

<span style="color: blue">end </span>writeBoolean;
</div>
<br clear="all" style="page-break-before: always">
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE writeComparison<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealI.png" alt="Physiolibrary.Types.FilesUtilities.writeComparison" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Types.FilesUtilities.writeComparison"></a><a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities"
>Physiolibrary.Types.FilesUtilities</a>.writeComparison</h2>
<p>
<b>Compare and write the result and the value to file</b>
</p>
<h3>Information</h3>
<p>Extends from <a href="Physiolibrary_Types_Utilities.html#Physiolibrary.Types.Utilities.writeComparison"
></a> (Compare and write the result and the value to file).</p>
<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>name</td><td>&nbsp;</td><td>Variable name</td></tr>
<tr><td>Real</td><td>defaultValue</td><td>&nbsp;</td><td>Original value[in SIunits] to compare with final value</td></tr>
<tr><td>Real</td><td>initialValue</td><td>&nbsp;</td><td>Initial variable value[in SI units]</td></tr>
<tr><td>Real</td><td>finalValue</td><td>&nbsp;</td><td>Final variable value[in SI units]</td></tr>
<tr><td>String</td><td>storeUnit</td><td>&nbsp;</td><td>Prefered units to store variable value</td></tr>
<tr><td><a href="Physiolibrary_Types_Utilities_UnitConversions.html#Physiolibrary.Types.Utilities.UnitConversions.RealTypeRecord"
>RealTypeRecord</a></td><td>unitConversions[:]</td><td>UnitConversions.RealTypeDef</td><td>Unit conversions</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">redeclare </span><span style="color: blue">function</span> <span style="color: blue">extends </span>writeComparison <span style="color: #006400">
  &quot;Compare and write the result and the value to file&quot;</span>
  <span style="color: blue">import </span><a href="Modelica_Utilities.html#Modelica.Utilities"
>Modelica.Utilities</a>.*;

<span style="color: blue">protected </span>
  String fn;
  Real outputInitialValue;
  Real outputFinalValue;
  Real outputDefaultValue;
  Integer typeDef <span style="color: #006400">&quot;Variable output units&quot;</span>;

<span style="color: blue">algorithm </span>
  fn:=directoryName + &quot;/&quot; +comparisonFileName;

  <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(fn)<span style="color: blue"> then</span>
     <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(&quot;output&quot;)<span style="color: blue"> then</span>
      <span style="color: red">   Files.createDirectory</span>(&quot;output&quot;);
     <span style="color: blue">end if</span>;
  <span style="color: blue">end if</span>;

  typeDef:=<span style="color: red">UnitConversions.findUnit</span>(storeUnit,unitConversions);

outputDefaultValue :=((defaultValue - unitConversions[typeDef].Offset)/unitConversions[typeDef].Scale);
outputInitialValue :=((initialValue - unitConversions[typeDef].Offset)/unitConversions[typeDef].Scale);
outputFinalValue :=((finalValue - unitConversions[typeDef].Offset)/unitConversions[typeDef].Scale);

  <span style="color: red">Streams.print</span>((<span style="color: blue">if </span>(<span style="color: red">abs</span>(outputDefaultValue) &gt; Modelica.Constants.eps)<span style="color: blue">
     then </span><span style="color: red">String</span>(<span style="color: red">abs</span>((outputFinalValue - outputDefaultValue)/
    outputDefaultValue))<span style="color: blue"> else </span>&quot;Zero vs. &quot; +<span style="color: red"> String</span>(outputFinalValue)) +
    &quot; ; &quot; + name + &quot; : default=&quot; +<span style="color: red"> String</span>(outputDefaultValue) + &quot; &quot; +
    unitConversions[typeDef].DisplayUnit
     + &quot;, initial=&quot; +<span style="color: red"> String</span>(outputInitialValue) + &quot; &quot; + unitConversions[
    typeDef].DisplayUnit + &quot;, final=&quot; +<span style="color: red"> String</span>(outputFinalValue) + &quot; &quot; +
    unitConversions[typeDef].DisplayUnit,
    fn);

<span style="color: blue">end </span>writeComparison;
</div>
<br clear="all" style="page-break-before: always">
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE writeComparison_SI<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealI.png" alt="Physiolibrary.Types.FilesUtilities.writeComparison_SI" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Types.FilesUtilities.writeComparison_SI"></a><a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities"
>Physiolibrary.Types.FilesUtilities</a>.writeComparison_SI</h2>
<p>
<b>Compare and write the result and the value to file using SI units</b>
</p>
<h3>Information</h3>
<p>Extends from <a href="Physiolibrary_Types_Utilities.html#Physiolibrary.Types.Utilities.writeComparison_SI"
></a> (Compare and write the result and the value to file using SI units).</p>
<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>name</td><td>&nbsp;</td><td>Variable name</td></tr>
<tr><td>Real</td><td>defaultValue</td><td>&nbsp;</td><td>Original value[in SIunits] to compare with final value</td></tr>
<tr><td>Real</td><td>initialValue</td><td>&nbsp;</td><td>Initial variable value[in SI units]</td></tr>
<tr><td>Real</td><td>finalValue</td><td>&nbsp;</td><td>Final variable value[in SI units]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">redeclare </span><span style="color: blue">function</span> <span style="color: blue">extends </span>writeComparison_SI <span style="color: #006400">
  &quot;Compare and write the result and the value to file using SI units&quot;</span>
  <span style="color: blue">import </span><a href="Modelica_Utilities.html#Modelica.Utilities"
>Modelica.Utilities</a>.*;

<span style="color: blue">protected </span>
  String fn;
  Real outputInitialValue;
  Real outputFinalValue;
  Real outputDefaultValue;

<span style="color: blue">algorithm </span>
  fn:=directoryName + &quot;/&quot; +comparisonSIFileName;

  <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(fn)<span style="color: blue"> then</span>
     <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(&quot;output&quot;)<span style="color: blue"> then</span>
      <span style="color: red">   Files.createDirectory</span>(&quot;output&quot;);
     <span style="color: blue">end if</span>;
  <span style="color: blue">end if</span>;

outputDefaultValue := defaultValue;
outputInitialValue := initialValue;
outputFinalValue := finalValue;

<span style="color: red">Streams.print</span>((<span style="color: blue">if </span>(<span style="color: red">abs</span>(outputDefaultValue) &gt; Modelica.Constants.eps)<span style="color: blue"> then </span>
  <span style="color: red">String</span>(<span style="color: red">abs</span>((outputFinalValue - outputDefaultValue)/outputDefaultValue))<span style="color: blue">
   else </span>&quot;Zero vs. &quot; +<span style="color: red"> String</span>(outputFinalValue)) + &quot; ; &quot; + name +
  &quot; : default=&quot; +<span style="color: red"> String</span>(outputDefaultValue) + &quot;, initial=&quot; +<span style="color: red"> String</span>(outputInitialValue)
   + &quot;, final=&quot; +<span style="color: red"> String</span>(outputFinalValue), fn);

<span style="color: blue">end </span>writeComparison_SI;
</div>
<br clear="all" style="page-break-before: always">
<!--[if supportFields]><span style="mso-element:field-begin"></span>
<span style="mso-spacerun:yes"></span>XE writeBooleanComparison<![endif]-->
<!--[if supportFields]><span style="mso-element:field-end"></span><![endif]-->
<h2><img src="Physiolibrary.Types.Files364b309f67e5d30fdRealI.png" alt="Physiolibrary.Types.FilesUtilities.writeBooleanComparison" align="right" style="border: 1px solid" width="80" height="80">
<a name="Physiolibrary.Types.FilesUtilities.writeBooleanComparison"></a><a href="Physiolibrary_Types_FilesUtilities.html#Physiolibrary.Types.FilesUtilities"
>Physiolibrary.Types.FilesUtilities</a>.writeBooleanComparison</h2>
<p>
<b>Compare and write the result and the value to file</b>
</p>
<h3>Information</h3>
<p>Extends from <a href="Physiolibrary_Types_Utilities.html#Physiolibrary.Types.Utilities.writeBooleanComparison"
></a> (Compare and write the result and the value to file).</p>
<h3>Inputs</h3>
<table border="1" cellspacing="0" cellpadding="2" summary="Inputs">
<tr><th>Type</th><th>Name</th><th>Default</th><th>Description</th></tr>
<tr><td>String</td><td>name</td><td>&nbsp;</td><td>Variable name</td></tr>
<tr><td>Boolean</td><td>defaultValue</td><td>&nbsp;</td><td>Original value[in SIunits] to compare with final value</td></tr>
<tr><td>Boolean</td><td>initialValue</td><td>&nbsp;</td><td>Initial variable value[in SI units]</td></tr>
<tr><td>Boolean</td><td>finalValue</td><td>&nbsp;</td><td>Final variable value[in SI units]</td></tr>
</table>
<h3>Modelica definition</h3>
<div class="modelica"><span style="color: blue">redeclare </span><span style="color: blue">function</span> <span style="color: blue">extends </span>writeBooleanComparison <span style="color: #006400">
  &quot;Compare and write the result and the value to file&quot;</span>
  <span style="color: blue">import </span><a href="Modelica_Utilities.html#Modelica.Utilities"
>Modelica.Utilities</a>.*;

<span style="color: blue">protected </span>
  String fn;
  Real outputInitialValue;
  Real outputFinalValue;
  Real outputDefaultValue;
<span style="color: blue">algorithm </span>
  fn:=directoryName + &quot;/&quot; +comparisonFileName;

  <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(fn)<span style="color: blue"> then</span>
     <span style="color: blue">if </span><span style="color: blue">not </span><span style="color: red">Files.exist</span>(&quot;output&quot;)<span style="color: blue"> then</span>
      <span style="color: red">   Files.createDirectory</span>(&quot;output&quot;);
     <span style="color: blue">end if</span>;
  <span style="color: blue">end if</span>;
   <span style="color: blue">if </span>(defaultValue==finalValue)<span style="color: blue"> then</span>

    <span style="color: red">   Streams.print</span>(&quot;0 ; &quot;+ name + &quot; : default=&quot; +<span style="color: red"> String</span>(<span style="color: blue">if </span>defaultValue<span style="color: blue"> then </span>1<span style="color: blue"> else </span>0) +&quot;, initial=&quot; +<span style="color: red"> String</span>(<span style="color: blue">if </span>initialValue<span style="color: blue"> then </span>1<span style="color: blue"> else </span>0) + &quot;, final=&quot; +<span style="color: red"> String</span>(<span style="color: blue">if </span>finalValue<span style="color: blue"> then </span>1<span style="color: blue"> else </span>0), &quot;differences.txt&quot;);
     <span style="color: blue">else</span>
    <span style="color: red">   Streams.print</span>(&quot;! ; &quot; + name + &quot; : default=&quot; +<span style="color: red"> String</span>(<span style="color: blue">if </span>defaultValue<span style="color: blue"> then </span>1<span style="color: blue"> else </span>0) +&quot;, initial=&quot; +<span style="color: red"> String</span>(<span style="color: blue">if </span>initialValue<span style="color: blue"> then </span>1<span style="color: blue"> else </span>0)+ &quot;, final=&quot; +<span style="color: red"> String</span>(<span style="color: blue">if </span>finalValue<span style="color: blue"> then </span>1<span style="color: blue"> else </span>0), &quot;differences.txt&quot;);
   <span style="color: blue">end if</span>;

<span style="color: blue">end </span>writeBooleanComparison;
</div>
<address>
<a href="http://www.3ds.com/">Automatically generated</a> Sun Dec 07 18:19:24 2014.
</address>
</body>
</html>
